
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://pnp.github.io/contoso/list-view-invoke/tech-details/">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Tech Details - Contoso Corporation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.38780c08.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f72e892.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue" data-md-color-accent="">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#list-view-invoke-tech-details" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://pnp.github.io/contoso/" title="Contoso Corporation" class="md-header-nav__button md-logo" aria-label="Contoso Corporation">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Contoso Corporation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Tech Details
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/pnp/contoso/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://pnp.github.io/contoso/" title="Contoso Corporation" class="md-nav__button md-logo" aria-label="Contoso Corporation">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    Contoso Corporation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/pnp/contoso/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      File Handler
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="File Handler" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        File Handler
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../file-handler/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../file-handler/tech-details/" class="md-nav__link">
      Tech Details
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Remote Document Generation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Remote Document Generation" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Remote Document Generation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../setup/" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../multi-tenant/" class="md-nav__link">
      Enable Multi-tenant Auth
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Tech Details
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Tech Details
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sharepoint-framework" class="md-nav__link">
    SharePoint Framework
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#azure-functions" class="md-nav__link">
    Azure Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#azure-service-bus" class="md-nav__link">
    Azure Service Bus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-links" class="md-nav__link">
    Reference Links
  </a>
  
    <nav class="md-nav" aria-label="Reference Links">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spfx-app" class="md-nav__link">
    SPFx app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#azure-functions_1" class="md-nav__link">
    Azure Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-bus" class="md-nav__link">
    Service Bus
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sharepoint-framework" class="md-nav__link">
    SharePoint Framework
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#azure-functions" class="md-nav__link">
    Azure Functions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#azure-service-bus" class="md-nav__link">
    Azure Service Bus
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reference-links" class="md-nav__link">
    Reference Links
  </a>
  
    <nav class="md-nav" aria-label="Reference Links">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#spfx-app" class="md-nav__link">
    SPFx app
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#azure-functions_1" class="md-nav__link">
    Azure Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#service-bus" class="md-nav__link">
    Service Bus
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/pnp/contoso/tree/main/docs/list-view-invoke/tech-details.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="list-view-invoke-tech-details">List View Invoke Tech Details<a class="headerlink" href="#list-view-invoke-tech-details" title="Permanent link">&para;</a></h1>
<p>This solution was built using SharePoint Framework (SPFx), Azure Functions, and Azure Service Bus choices discussed below. We used <a href="https://www.typescriptlang.org/">TypeScript</a> to build all of the pieces of our solution, however the function piece could just as easily been written in any language available to run on Azure Functions. SPFx, as a client-side technology, requires the use of TypeScript or JavaScript.</p>
<p>Additionally, there is a list of <a href="#reference-links">reference links</a> we found useful while building our solution.</p>
<h2 id="sharepoint-framework">SharePoint Framework<a class="headerlink" href="#sharepoint-framework" title="Permanent link">&para;</a></h2>
<p><a href="https://aka.ms/spfx">SharePoint Framework</a> (SPFx) is the way to add UI features including client-side code in SharePoint Online. We used a <a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/extensions/get-started/building-simple-cmdset-with-dialog-api">List View Command Set extension</a> to include our button directly into the UI for Libraries. This allows us to know to where we will write the generated document, along with who initiated the request. This is done using the <a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/use-aadhttpclient">built in capabilities</a> of SPFx to call AAD secured APIs.</p>
<h2 id="azure-functions">Azure Functions<a class="headerlink" href="#azure-functions" title="Permanent link">&para;</a></h2>
<p><a href="https://docs.microsoft.com/en-us/azure/azure-functions/">Azure Functions</a> are a cost effective, secure way to deploy solutions to Azure. While not appropriate for all applications the capabilities of functions met our needs. This solution could work similiarly using a full web app, VM, or other hosting while the flow remains the same. The key advantage of Azure Functions for us was the simple setup of authentication to ensure our solution is secure.</p>
<p>We used two functions, one to receive and queue the request and a second to do the work, to illustrate one way to help handle scale by ensuring a quick response back to the user, while providing time to complete the operations.</p>
<h2 id="azure-service-bus">Azure Service Bus<a class="headerlink" href="#azure-service-bus" title="Permanent link">&para;</a></h2>
<p>The <a href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/">Service Bus</a> allows us to create a buffer between requests (fast, many) and document generation (slower). This is a lightweight way to scale an application and met our needs - we also considered <a href="https://azure.microsoft.com/en-us/products/azure-sql/">Azure SQL</a>, but simple messaging worked in this case.</p>
<p>One consideration is that we are storing the user's bearer token within the queue message. OK for a sample, but the handling of tokens in production should adhear to the <a href="https://docs.microsoft.com/en-us/azure/architecture/example-scenario/secrets/secure-refresh-tokens">best available guidance</a>.</p>
<h2 id="reference-links">Reference Links<a class="headerlink" href="#reference-links" title="Permanent link">&para;</a></h2>
<p>We found the following list of links helpful while developing our solution:</p>
<h3 id="spfx-app">SPFx app<a class="headerlink" href="#spfx-app" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/extensions/get-started/building-simple-cmdset-with-dialog-api">Build your first ListView Command Set extension</a></li>
<li><a href="https://docs.microsoft.com/en-us/sharepoint/dev/spfx/use-aadhttpclient">Connect to Azure AD-secured APIs in SharePoint Framework solutions</a></li>
</ul>
<h3 id="azure-functions_1">Azure Functions<a class="headerlink" href="#azure-functions_1" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/">Overview</a></li>
<li><a href="https://github.com/Azure/azure-functions-core-tools">Tools</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-bindings-http-webhook">Http Triggered Functions</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/scripts/functions-cli-create-serverless">Create a function app for serverless code execution</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/security-concepts">Securing Azure Functions</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/app-service/overview-authentication-authorization#token-store">Token Store</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/configure-user-consent?tabs=azure-portal">Configure how end-users consent to applications</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/app-service/configure-authentication-provider-aad">Configure your App Service or Azure Functions app to use Azure AD login</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-reference-node?tabs=v2">Azure Functions JavaScript developer guide</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/app-service/tutorial-auth-aad?pivots=platform-linux#call-api-securely-from-browser-code">Call API securely from browser code</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow">Microsoft identity platform and OAuth 2.0 On-Behalf-Of flow</a></li>
</ul>
<h3 id="service-bus">Service Bus<a class="headerlink" href="#service-bus" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-quickstart-portal">Overview</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-nodejs-how-to-use-queues">Send messages to and receive messages from Azure Service Bus queues (JavaScript)</a></li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../multi-tenant/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Enable Multi-tenant Auth
              </div>
            </div>
          </a>
        
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.77e55a48.min.js"></script>
      <script src="../../assets/javascripts/bundle.9554a270.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>